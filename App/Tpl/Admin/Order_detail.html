<!DOCTYPE html>
<html lang="en">

	<head>
    	<meta charset="UTF-8" />
		<title>会议室预约查找</title>
		<include file='App/Tpl/Common/csslist.html' />	
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
		<link href="__PUBLIC__/vendor/jquery-datatables-bs3/css/datatables.css" rel="stylesheet"/>
		<script src="__PUBLIC__/js/modernizr.js"></script>
		<style type="text/css">
			#mytable_paginate a{
				color:#777
			  }
			  .paginate_button{
				  margin-right:20px;
			  }
		</style>
	</head>
	
	<body>
         
		<include file='App/Tpl/Common/header_admin.html'/>	
		<div class="container-fluid content">	
			<div class="row">
                <include file='App/Tpl/Common/sidebar_admin.html'/>
				<div class="main ">
					<div class="page-header">
						<div class="pull-left">
							<ol class="breadcrumb visible-sm visible-md visible-lg">								
								<li><a href="{:U('Admin/Order/index')}"><i class="icon fa fa-home"></i>主页</a></li>
								<li class="active"><i class="fa fa-laptop"></i>{$day}</li>
							</ol>						
						</div>
						<div class="pull-right">
							<h2>会议室预约查找</h2>
						</div>					
					</div>
                


                        <div class="row">
						<div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
							<div class="panel panel-default bk-bg-white">
								<div class="panel-heading bk-bg-white">
									<h6><i class="fa fa-table red"></i>
										 
										<span class="break">{$day}	
										</span>					
								 
										<input type="hidden" name="Submit" id="date" value="{$day}">
									</h6>
									<div class="panel-actions">
										<a href="#" class="btn-minimize"><i class="fa fa-caret-up"></i></a>
										<a href="#" class="btn-close"><i class="fa fa-times"></i></a>
									</div>				
								</div>
								<div class="panel-body">	
                                    <form action="#" method="post" class="form-horizontal " id="find">	
									   <div class="form-group">
										 
										 
												<label class="control-label col-md-2" for="select">会议室名称</label>
												<div class="col-md-9">
													<select id="housename" name="select0" class="form-control" size="1">
															<option value="0"></option>
														<foreach name="allhouse" item="b">
															<option value="{$b['house_id']}">{$b['house_name']}</option>
														</foreach>
													</select>
												</div>
									 


											
										</div>	
										<div class="form-group" >
											<label class="control-label col-md-2" for="select">起始时间</label>
											<div class="col-md-9">
												<select id="tselect" name="time_select1" class="form-control" size="1">
													<option value="0">请输入起始时间</option>
													<option value="0">8:00</option>
													<option value="1">8:30</option>
													<option value="2">9:00</option>
													<option value="3">9:30</option>
													<option value="4">10:00</option>
													<option value="5">10:30</option>
													<option value="6">11:00</option>
													<option value="7">11:30</option>
													<option value="8">12:00</option>
													<option value="9">12:30</option>
													<option value="10">13:00</option>
													<option value="11">13:30</option>
													<option value="12">14:00</option>
													<option value="13">14:30</option>
													<option value="14">15:00</option>
													<option value="15">15:30</option>
													<option value="16">16:00</option>
													<option value="17">16:30</option>
													<option value="18">17:00</option>
													<option value="19">17:30</option>
													<option value="20">18:00</option>
													<option value="21">18:30</option>
													<option value="22">19:00</option>
													<option value="23">19:30</option>
													<option value="24">20:00</option>
													<option value="25">20:30</option>
													<option value="26">21:00</option>
													<option value="27">21:30</option>
												</select>
											</div>
										</div>

										<div class="form-group">
											<label class="control-label col-md-2" for="select">结束时间</label>
											<div class="col-md-9">
												<select id="tselect" name="time_select2" class="form-control" size="1">
													<option value="27">请输入结束时间</option>
													<option value="1">8:30</option>
													<option value="2">9:00</option>
													<option value="3">9:30</option>
													<option value="4">10:00</option>
													<option value="5">10:30</option>
													<option value="6">11:00</option>
													<option value="7">11:30</option>
													<option value="8">12:00</option>
													<option value="9">12:30</option>
													<option value="10">13:00</option>
													<option value="11">13:30</option>
													<option value="12">14:00</option>
													<option value="13">14:30</option>
													<option value="14">15:00</option>
													<option value="15">15:30</option>
													<option value="16">16:00</option>
													<option value="17">16:30</option>
													<option value="18">17:00</option>
													<option value="19">17:30</option>
													<option value="20">18:00</option>
													<option value="21">18:30</option>
													<option value="22">19:00</option>
													<option value="23">19:30</option>
													<option value="24">20:00</option>
													<option value="25">20:30</option>
													<option value="26">21:00</option>
													<option value="27">21:30</option>
													<option value="28">22:00</option>
												</select>
											</div>
											
	
											
										</div>
										<div class="form-group">
												<button type="submit" name="Submit"  style="margin-left:80%;" class="btn btn-danger">查找</button>
										</div>				
										
								<!--		<div class="col-md-8">
											<div class="radio-custom radio-inline">
												<input type="radio" id="inline-radio1" name="inline-radios" value="1"> 
											</div>												
											<input type="submit" name="Submit" value="查找">										 
										</div>-->
									</form>

                        


									<table class="table table-bordered table-striped mb-none" id="mytable">
                                            <thead>
                                                <tr>
                                                    <th>会议室</th>
													<th>可用时间段</th>
													<th>预约</th>
                                                </tr>
                                            </thead>
                                            <tbody>
												<foreach name="query" item="row"> 
													<tr>
                                                            <td>{$row['house_name']}</td>
															<td>{$row['time']}</td>
															
															<td>
																<div class="checkbox-custom">
																	<input type="checkbox" class="checkbox1" name="checkbox1" value="option1"> 
																	<label for="checkbox1"></label>
																</div>
															</td>
													</tr>
												</foreach>
										</tbody>
									</table>
								</div>
							</div>
						</div>
					</div>	

				<!-- End Main Page -->			
		
			 
			
			</div>
		</div><!--/container-->
			
		
		<div class="clearfix"></div>		
		
		
		<!-- start: JavaScript-->
     
        
        <include file='App/Tpl/Common/footer.html'/>
		<include file='App/Tpl/Common/jslists.html'/>
		<script src="__PUBLIC__/js/pages/index.js"></script>

		<script>
			$("#sure").click(function() {
				var day=$("#date").val();
				var myarray=[];
				var house;
				var timearray="";
				$(".checkbox1").each(function(){
					if($(this).attr("checked")){
						myarray.push({"house_name":$(this).parent().parent().prev().prev().html(),"time":$(this).parent().parent().prev().html()});
					}
				})
				if(myarray.length==0)
				{
					alert("请至少选择一条记录！");
					return;
				}
				for (i=0;i<myarray.length-1;i++)
				{
					if(myarray[i]["house_name"]!=myarray[i+1]["house_name"])
					{
						alert("只能选择一个教室！");
						return;
					}
				}
				house=myarray[0]["house_name"];
				for (i=0;i<myarray.length;i++)
				{
					timearray+=myarray[i]["time"]+"_";
				}
				tourl = "{:U('Admin/Order/form',array('date' => 'myurl1','housename'=>'myurl2','time'=>'myurl3'))}";
					tourl=tourl.replace('myurl1',day);
					tourl=tourl.replace('myurl2',house);
					tourl=tourl.replace('myurl3',timearray);

					console.log(tourl);
					location.href = tourl;
            });

		</script>

		<script src="__PUBLIC__/vendor/jquery-datatables-bs3/js/jquery.dataTables.min.js"></script>
		<script>
			$("#mytable").DataTable({
					"paging": true,
					"iDisplayLength": 10, //默认每页数量
					"bPaginate": true, //翻页功能
					"bLengthChange": false, //改变每页显示数据数量
					"bFilter": false, //过滤功能
					"bInfo": true, //页脚信息
					"bAutoWidth": true, //自动宽度
					"bRetrieve": true,
					"processing": true,
					//"ordering": false,
					//"bSort": false, 
					//"serverSide" : true,//服务器端进行分页处理的意思
					//"bPaginate": true,
					//"bProcessing": true
					columns : [{data : "id"},{data:"value"},{data:"value2"}],
			});
		</script>

		<!-- end: JavaScript-->
		
	</body>
	
</html>